[{"url":"https://api.github.com/repos/bio-guoda/preston/issues/comments/652062406","html_url":"https://github.com/bio-guoda/preston/issues/66#issuecomment-652062406","issue_url":"https://api.github.com/repos/bio-guoda/preston/issues/66","id":652062406,"node_id":"MDEyOklzc3VlQ29tbWVudDY1MjA2MjQwNg==","user":{"login":"mielliott","id":9602463,"node_id":"MDQ6VXNlcjk2MDI0NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9602463?v=4","gravatar_id":"","url":"https://api.github.com/users/mielliott","html_url":"https://github.com/mielliott","followers_url":"https://api.github.com/users/mielliott/followers","following_url":"https://api.github.com/users/mielliott/following{/other_user}","gists_url":"https://api.github.com/users/mielliott/gists{/gist_id}","starred_url":"https://api.github.com/users/mielliott/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mielliott/subscriptions","organizations_url":"https://api.github.com/users/mielliott/orgs","repos_url":"https://api.github.com/users/mielliott/repos","events_url":"https://api.github.com/users/mielliott/events{/privacy}","received_events_url":"https://api.github.com/users/mielliott/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-06-30T21:44:22Z","updated_at":"2020-06-30T21:44:22Z","body":"See https://github.com/bio-guoda/preston/commit/07ec0b8947b5b36a9e9dac708c3b5d9d8e35c078\r\n\r\nI added `TlshTokenizerTest` (in the `search-indexing` branch), which includes a tokenizer that translates a TLSH hash string (not including the \"hash://tika-tlsh/\" part) into a stream of tokens usable by Lucene. The tests include building the index and querying for similar TLSH strings.\r\n\r\nThe tokenizer breaks each hexadecimal character in the TLSH string into two 2-bit bins and keeps track of the position of each bin. So, a 1-character string \"7\" (0111 binary) would be tokenized into two terms, \"01 @ position 0\" and \"11 @ position 1\". In the implementation, the bin position and bin value are packed into a single integer.\r\n\r\nSo, the hex string `deadbeef` is tokenized into `3 5 11 14 18 22 27 29 34 39 43 46 51 54 59 63`. When this string is used as a Lucene query, it's interpreted as \"find indexed tlsh hashes containing terms 3 or 5 or 11 or ... or 63\" and any hits (indexed tlsh hashes that share at least one of those terms) are scored according to the number of shared terms.\r\n\r\n@jhpoelen ","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/bio-guoda/preston/issues/comments/652062406/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/bio-guoda/preston/issues/comments/652531772","html_url":"https://github.com/bio-guoda/preston/issues/66#issuecomment-652531772","issue_url":"https://api.github.com/repos/bio-guoda/preston/issues/66","id":652531772,"node_id":"MDEyOklzc3VlQ29tbWVudDY1MjUzMTc3Mg==","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-01T16:49:10Z","updated_at":"2020-07-01T16:51:07Z","body":"@mielliott thanks for sharing your implementation prototype of a method to use Lucene to index tlsh hashes to find similar tlsh hashes. I can see how the indexing would work. \r\n\r\nSome open questions:\r\n\r\n1. how do you imagine the index process to work? In other words, what is the workflow to create an index from a given provenance log with tlsh hashes and how would you record this process and it's resulting index? What preston command would be used to trigger this process? \r\n2. how do you imagine to calculate and describe the similarities between tlsh hashes and connect these to a specific the search index used to calculate them? What preston command would be used to trigger this process (related to #67)\r\n3. how many tlsh hashes can be indexed per second? \r\n4. how does the resulting lucene index scale with the number of tlsh hashes indexed? \r\n5. how do you imagine defining and recording a threshold for tlsh distance/similarity? (related to #66)","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/bio-guoda/preston/issues/comments/652531772/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/bio-guoda/preston/issues/comments/655867525","html_url":"https://github.com/bio-guoda/preston/issues/66#issuecomment-655867525","issue_url":"https://api.github.com/repos/bio-guoda/preston/issues/66","id":655867525,"node_id":"MDEyOklzc3VlQ29tbWVudDY1NTg2NzUyNQ==","user":{"login":"mielliott","id":9602463,"node_id":"MDQ6VXNlcjk2MDI0NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9602463?v=4","gravatar_id":"","url":"https://api.github.com/users/mielliott","html_url":"https://github.com/mielliott","followers_url":"https://api.github.com/users/mielliott/followers","following_url":"https://api.github.com/users/mielliott/following{/other_user}","gists_url":"https://api.github.com/users/mielliott/gists{/gist_id}","starred_url":"https://api.github.com/users/mielliott/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mielliott/subscriptions","organizations_url":"https://api.github.com/users/mielliott/orgs","repos_url":"https://api.github.com/users/mielliott/repos","events_url":"https://api.github.com/users/mielliott/events{/privacy}","received_events_url":"https://api.github.com/users/mielliott/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-09T02:59:33Z","updated_at":"2020-07-09T02:59:33Z","body":"I've added a `SimilarityIndexTikaTLSH` class in the `search-indexing` branch. It's intended to be used by a processor to incrementally index SHA256-TikaTLSH pairs and find similar contents. It exposes two functions:\r\nhttps://github.com/bio-guoda/preston/blob/a44291b34f4ad0647a01622b982f18f9952e22b1/src/main/java/bio/guoda/preston/index/SimilarityIndexTikaTLSH.java#L85\r\nhttps://github.com/bio-guoda/preston/blob/a44291b34f4ad0647a01622b982f18f9952e22b1/src/main/java/bio/guoda/preston/index/SimilarityIndexTikaTLSH.java#L61\r\n\r\nHere's a simple processor using those functions:\r\nhttps://github.com/bio-guoda/preston/blob/f8b34a894bbffc6646d590069767c9eb82ad0fe1/src/main/java/bio/guoda/preston/process/SimilarContentFinder.java#L10-L37\r\n\r\nStill need to emit statements (as discussed in #67) and add a Preston command to run a similar-content-finding processor.\r\n\r\nAlso, I still need to use the TLSH scoring algorithm when searching the index. For now, it's using `BM25Similarity`.","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/bio-guoda/preston/issues/comments/655867525/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/bio-guoda/preston/issues/comments/656142915","html_url":"https://github.com/bio-guoda/preston/issues/66#issuecomment-656142915","issue_url":"https://api.github.com/repos/bio-guoda/preston/issues/66","id":656142915,"node_id":"MDEyOklzc3VlQ29tbWVudDY1NjE0MjkxNQ==","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-07-09T13:56:12Z","updated_at":"2020-07-09T13:56:12Z","body":"Thanks for sharing an initial implementation on the branch and working towards addressing question 1 (e.g., how does the indexing work?). I am curious to learn more about what happens when you run this method again real data at scale after merging this into main. ","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/bio-guoda/preston/issues/comments/656142915/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/bio-guoda/preston/issues/comments/1518256089","html_url":"https://github.com/bio-guoda/preston/issues/66#issuecomment-1518256089","issue_url":"https://api.github.com/repos/bio-guoda/preston/issues/66","id":1518256089,"node_id":"IC_kwDOCMmefs5afr_Z","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-21T19:33:45Z","updated_at":"2023-04-21T19:33:45Z","body":"Similarity hashes are useful and for sake of simplicity, temporarily no longer support by Preston.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/bio-guoda/preston/issues/comments/1518256089/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]