[{"url":"https://api.github.com/repos/bio-guoda/preston/issues/comments/855183569","html_url":"https://github.com/bio-guoda/preston/issues/123#issuecomment-855183569","issue_url":"https://api.github.com/repos/bio-guoda/preston/issues/123","id":855183569,"node_id":"MDEyOklzc3VlQ29tbWVudDg1NTE4MzU2OQ==","user":{"login":"mielliott","id":9602463,"node_id":"MDQ6VXNlcjk2MDI0NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9602463?v=4","gravatar_id":"","url":"https://api.github.com/users/mielliott","html_url":"https://github.com/mielliott","followers_url":"https://api.github.com/users/mielliott/followers","following_url":"https://api.github.com/users/mielliott/following{/other_user}","gists_url":"https://api.github.com/users/mielliott/gists{/gist_id}","starred_url":"https://api.github.com/users/mielliott/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mielliott/subscriptions","organizations_url":"https://api.github.com/users/mielliott/orgs","repos_url":"https://api.github.com/users/mielliott/repos","events_url":"https://api.github.com/users/mielliott/events{/privacy}","received_events_url":"https://api.github.com/users/mielliott/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-05T04:54:46Z","updated_at":"2021-06-05T05:09:18Z","body":"I was able to reproduce the issue:\r\n\r\n```\r\n$ echo '<blah> <http://purl.org/pav/hasVersion> <hash://sha256/97cbeae429fbc95d1859f7afa28b33f08ac64125ba72511c49c4b77ca66d2d66> .' | preston grep --max 1 --\r\nremote https://deeplinker.bio | grep value | head -n2\r\n<line:zip:hash://sha256/97cbeae429fbc95d1859f7afa28b33f08ac64125ba72511c49c4b77ca66d2d66!/occurrence.txt!/L2> <http://www.w3.org/ns/prov#value> \"1-37067-988                                                                      This work is licensed under a Creative Commons CCZero 1.0 License http://creativecommons.org/publicdomain/zero/1.0/legalcode and available according to the community norms at http://www.canadensys.net/norms. The data provider requests to be informed of publication 45 days in advance and can object to the use of the dataset within 30 days.       CIRA                                                                                                       The data provider requests to be informed of publication 45 days in advance and can object to the use of the dataset within 30 days.                                                                                               BioFresh (publisher), Yukoni, T. and Torres L. V. (provider), Universidad Autónoma del Beni 'José Ballivian' (CIRA-UAB) (owner) (2015). Bolivian Amazon lowland fish metacommunity data. doi:10.13148/bfe105 Published on http://data.freshwaterbiodiversity.eu, accessed on [date].        doi:10.13148/bfe105     CIRA-UNAN       CIRA    PreservedSpecimen                                                                                                         waterBodyType=lake       1-37067-988     988     2       ML1-37067       25/06/01        2001    Site was sampled on 2 consecutive days. Date reported in the eventDate field is the first day of the visit.                       ML1      Manuripi        Bolivia Manuripi lake   -11.95204       -68.65672               Chalceus guaporensis Zanata & Toledo-Piza 2004                                                                                            Animalia Chalceidae      Chalceus        guaporensis     species Zanata & Toledo-Piza 2004\" <urn:uuid:169d7b87-da1f-43d9-aa5c-99069f543fa7> .\r\n<line:zip:hash://sha256/97cbeae429fbc95d1859f7afa28b33f08ac64125ba72511c49c4b77ca66d2d66!/occurrence.txt!/L3> <http://www.w3.org/ns/prov#value> \"2-37067-974                                                                      This work is licensed under a Creative Commons CCZero 1.0 License http://creativecommons.org/publicdomain/zero/1.0/legalcode and available according to the community norms at http://www.canadensys.net/norms. The data provider requests to be informed of publication 45 days in advance and can object to the use of the dataset within 30 days.       CIRA                                                                                                       The data provider requests to be informed of publication 45 days in advance and can object to the use of the dataset within 30 days.                                                                                               BioFresh (publisher), Yukoni, T. and Torres L. V. (provider), Universidad Autónoma del Beni 'José Ballivian' (CIRA-UAB) (owner) (2015). Bolivian Amazon lowland fish metacommunity data. doi:10.13148/bfe105 Published on http://data.freshwaterbiodiversity.eu, accessed on [date].        doi:10.13148/bfe105     CIRA-UNAN       CIRA    PreservedSpecimen                                                                                                         waterBodyType=lake       2-37067-974     974     1       ML1-37067       25/06/01        2001    Site was sampled on 2 consecutive days. Date reported in the eventDate field is the first day of the visit.                       ML1      Manuripi        Bolivia Manuripi lake   -11.95204       -68.65672       gr.     Acestrorhynchus gr. lacustris (Lütken 1875)                                                                                               Animalia Acestrorhynchidae       Acestrorhynchus gr. lacustris   species (Lütken 1875)\" <urn:uuid:169d7b87-da1f-43d9-aa5c-99069f543fa7> .\r\n```\r\n\r\nLooks like I forgot to increment the match counter when reporting whole lines. All better now, as of https://github.com/bio-guoda/preston/commit/7e2f737b11dc5d7541f5973f973bcb7b7c56e19f:\r\n\r\n```\r\n$ echo '<blah> <http://purl.org/pav/hasVersion> <hash://sha256/97cbeae429fbc95d1859f7afa28b33f08ac64125ba72511c49c4b77ca66d2d66> .' | preston grep --max 1 --remote https://deeplinker.bio | grep value | head -n2\r\n<line:zip:hash://sha256/97cbeae429fbc95d1859f7afa28b33f08ac64125ba72511c49c4b77ca66d2d66!/occurrence.txt!/L2> <http://www.w3.org/ns/prov#value> \"1-37067-988                                                                      This work is licensed under a Creative Commons CCZero 1.0 License http://creativecommons.org/publicdomain/zero/1.0/legalcode and available according to the community norms at http://www.canadensys.net/norms. The data provider requests to be informed of publication 45 days in advance and can object to the use of the dataset within 30 days.       CIRA                                                                                                       The data provider requests to be informed of publication 45 days in advance and can object to the use of the dataset within 30 days.\r\n```\r\n\r\nSorry about that!","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/bio-guoda/preston/issues/comments/855183569/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/bio-guoda/preston/issues/comments/855184913","html_url":"https://github.com/bio-guoda/preston/issues/123#issuecomment-855184913","issue_url":"https://api.github.com/repos/bio-guoda/preston/issues/123","id":855184913,"node_id":"MDEyOklzc3VlQ29tbWVudDg1NTE4NDkxMw==","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-05T05:06:44Z","updated_at":"2021-06-05T05:06:44Z","body":"@mielliott very nice! Thanks for making this happen. I was able to confirm your fix by running\r\n\r\n```\r\n$ preston ls | preston grep --max 1 \"tdwg\" | grep value | head -n2\r\n<line:zip:hash://sha256/97cbeae429fbc95d1859f7afa28b33f08ac64125ba72511c49c4b77ca66d2d66!/meta.xml!/L1> <http://www.w3.org/ns/prov#value> \"<archive xmlns=\\\"http://rs.tdwg.org/dwc/text/\\\" metadata=\\\"eml.xml\\\">\" <urn:uuid:afac017d-72ed-4ba2-9818-880c908bd978> .\r\n<line:zip:hash://sha256/e0587e3526a5540c669cfbf90cd47bddec57f9e971f24dd8a36c480c3c3ec8eb!/meta.xml!/L2> <http://www.w3.org/ns/prov#value> \"<archive xmlns=\\\"http://rs.tdwg.org/dwc/text/\\\" metadata=\\\"eml.xml\\\">\" <urn:uuid:d4ab8596-dc3a-456f-84cf-3c546fd46fd3> .\r\n```\r\n\r\nand noticing the different hashes for first two lines. \r\n\r\nand, as before, the result below holds too\r\n\r\n```\r\n$ preston ls | preston grep -o --max 1 \"tdwg\" | grep value | head -n2\r\n<cut:line:zip:hash://sha256/97cbeae429fbc95d1859f7afa28b33f08ac64125ba72511c49c4b77ca66d2d66!/meta.xml!/L1!/b27-30> <http://www.w3.org/ns/prov#value> \"tdwg\" <urn:uuid:c00a7c73-cb25-4dcb-a334-1a6b20c25f6b> .\r\n<cut:line:zip:hash://sha256/e0587e3526a5540c669cfbf90cd47bddec57f9e971f24dd8a36c480c3c3ec8eb!/meta.xml!/L2!/b27-30> <http://www.w3.org/ns/prov#value> \"tdwg\" <urn:uuid:20b87903-869a-472f-b92b-4fd7edca75c6> .\r\n```\r\n\r\n\r\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/bio-guoda/preston/issues/comments/855184913/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/bio-guoda/preston/issues/comments/855190264","html_url":"https://github.com/bio-guoda/preston/issues/123#issuecomment-855190264","issue_url":"https://api.github.com/repos/bio-guoda/preston/issues/123","id":855190264,"node_id":"MDEyOklzc3VlQ29tbWVudDg1NTE5MDI2NA==","user":{"login":"mielliott","id":9602463,"node_id":"MDQ6VXNlcjk2MDI0NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9602463?v=4","gravatar_id":"","url":"https://api.github.com/users/mielliott","html_url":"https://github.com/mielliott","followers_url":"https://api.github.com/users/mielliott/followers","following_url":"https://api.github.com/users/mielliott/following{/other_user}","gists_url":"https://api.github.com/users/mielliott/gists{/gist_id}","starred_url":"https://api.github.com/users/mielliott/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mielliott/subscriptions","organizations_url":"https://api.github.com/users/mielliott/orgs","repos_url":"https://api.github.com/users/mielliott/repos","events_url":"https://api.github.com/users/mielliott/events{/privacy}","received_events_url":"https://api.github.com/users/mielliott/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-06-05T06:04:04Z","updated_at":"2021-06-05T06:04:04Z","body":"Sweet! Glad it's working. I've simplified the code to make sure this issue doesn't crop up again. 4a4d3fc6082a4d0ff5c6aed0c24eae206adda152","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/bio-guoda/preston/issues/comments/855190264/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]