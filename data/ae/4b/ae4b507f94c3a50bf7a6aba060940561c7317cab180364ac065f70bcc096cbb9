[{"url":"https://api.github.com/repos/bio-guoda/preston/issues/comments/511165769","html_url":"https://github.com/bio-guoda/preston/issues/15#issuecomment-511165769","issue_url":"https://api.github.com/repos/bio-guoda/preston/issues/15","id":511165769,"node_id":"MDEyOklzc3VlQ29tbWVudDUxMTE2NTc2OQ==","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-07-14T01:31:59Z","updated_at":"2019-07-14T01:41:06Z","body":"@mielliott I took a first pass at functionality for re-processing provenance logs and introduced: ```preston process``` . \r\n\r\nThe idea is to use stdin to feed existing provenance logs (whole or in part) into preston. Preston then takes processes each and every statement with it's content processors, and generated the original + new (if any) content and adds it as a new provenance log version.\r\n\r\nFor instance, to reprocess all existing logs, you can do:\r\n\r\n```preston ls | preston process```\r\n\r\nto include sub-selection of logs, you can do:\r\n\r\n```shell\r\n$ preston ls | grep gfbio | preston process\r\n<https://preston.guoda.bio> <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <h\r\nttp://www.w3.org/ns/prov#SoftwareAgent> .\r\n<https://preston.guoda.bio> <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <h\r\nttp://www.w3.org/ns/prov#Agent> .\r\n<https://preston.guoda.bio> <http://purl.org/dc/terms/description> \"Preston is a\r\n software program that finds, archives and provides access to biodiversity datas\r\nets.\"@en .\r\n<9a226967-1b33-4524-98c0-fcf5787a267d> <http://www.w3.org/1999/02/22-rdf-syntax-\r\nns#type> <http://www.w3.org/ns/prov#Activity> .\r\n<9a226967-1b33-4524-98c0-fcf5787a267d> <http://purl.org/dc/terms/description> \"A\r\nn event that (re-) processes existing biodiversity datasets graphs and their pro\r\nvenance.\"@en .\r\n<9a226967-1b33-4524-98c0-fcf5787a267d> <http://www.w3.org/ns/prov#startedAtTime>\r\n \"2019-07-14T01:14:49.151Z\"^^<http://www.w3.org/2001/XMLSchema#dateTime> .\r\n<9a226967-1b33-4524-98c0-fcf5787a267d> <http://www.w3.org/ns/prov#wasStartedBy> \r\n<https://preston.guoda.bio> .\r\n<0659a54f-b713-4f86-a917-5be166a14110> <http://www.w3.org/1999/02/22-rdf-syntax-\r\nns#type> <http://www.w3.org/ns/prov#Entity> .\r\n<0659a54f-b713-4f86-a917-5be166a14110> <http://purl.org/dc/terms/description> \"A\r\n biodiversity dataset graph archive.\"@en .\r\n<hash://sha256/4ae6725e255e58639a9f3ea15fe06ba015bfb25be5526fd803e6266266e4ba52>\r\n <http://www.w3.org/ns/prov#usedBy> <9a226967-1b33-4524-98c0-fcf5787a267d> .\r\n<https://bms.gfbio.org/services/data-sources/> <http://purl.org/pav/hasVersion> <hash://sha256/c512d491c472bc004ecdf5a0f30e226bc20bbaed1bdc05a9a08f973f19e18878>\r\n .\r\n<hash://sha256/c512d491c472bc004ecdf5a0f30e226bc20bbaed1bdc05a9a08f973f19e18878>\r\n <http://www.w3.org/ns/prov#hadMember> <https://ww3.bgbm.org/biocase/pywrapper.c\r\ngi?dsa=GFBio_ColiFauna&inventory=1> .\r\n<https://ww3.bgbm.org/biocase/pywrapper.cgi?dsa=GFBio_ColiFauna&inventory=1> <ht\r\ntp://purl.org/dc/elements/1.1/format> \"text/xml\" .\r\n<hash://sha256/c512d491c472bc004ecdf5a0f30e226bc20bbaed1bdc05a9a08f973f19e18878>\r\n <http://www.w3.org/ns/prov#hadMember> <https://ww3.bgbm.org/biocase/pywrapper.c\r\ngi?dsa=GFBio_eXist-db&inventory=1> .\r\n<https://ww3.bgbm.org/biocase/pywrapper.cgi?dsa=GFBio_eXist-db&inventory=1> <htt\r\np://purl.org/dc/elements/1.1/format> \"text/xml\" .\r\n<hash://sha256/c512d491c472bc004ecdf5a0f30e226bc20bbaed1bdc05a9a08f973f19e18878>\r\n <http://www.w3.org/ns/prov#hadMember> <https://ww3.bgbm.org/biocase/pywrapper.c\r\ngi?dsa=GFBio_eXist-db&inventory=1> .\r\n``` \r\n\r\nNote that only a pre-existing version of the bioCASe registry was needed (e.g., ```<https://bms.gfbio.org/services/data-sources/> <http://purl.org/pav/hasVersion <hash://sha256/c512....> .```) to generate the ```http://www.w3.org/ns/prov#hadMember``` relationships.\r\n\r\nThis is even more emphasized when running:\r\n\r\n```shell\r\n$ echo -e \"<https://bms.gfbio.org/services/data-sources/> <http://purl.org/pav/hasVersion> <hash://sha256/c512d491c472bc004ecdf5a0f30e226bc20bbaed1bdc05a9a08f973f19e18878> .\\n\" | preston process\r\n...\r\n<https://bms.gfbio.org/services/data-sources/> <http://purl.org/pav/hasVersion> <hash://sha256/c512d491c472bc004ecdf5a0f30e226bc20bbaed1bdc05a9a08f973f19e18878> .\r\n <http://www.w3.org/ns/prov#hadMember> <https://ww3.bgbm.org/biocase/pywrapper.c\r\ngi?dsa=GFBio_ColiFauna&inventory=1> .\r\n<https://ww3.bgbm.org/biocase/pywrapper.cgi?dsa=GFBio_ColiFauna&inventory=1> <ht\r\ntp://purl.org/dc/elements/1.1/format> \"text/xml\" .\r\n<hash://sha256/c512d491c472bc004ecdf5a0f30e226bc20bbaed1bdc05a9a08f973f19e18878>\r\n <http://www.w3.org/ns/prov#hadMember> <https://ww3.bgbm.org/biocase/pywrapper.c\r\ngi?dsa=GFBio_eXist-db&inventory=1> .\r\n<https://ww3.bgbm.org/biocase/pywrapper.cgi?dsa=GFBio_eXist-db&inventory=1> <htt\r\np://purl.org/dc/elements/1.1/format> \"text/xml\" .\r\n<hash://sha256/c512d491c472bc004ecdf5a0f30e226bc20bbaed1bdc05a9a08f973f19e18878>\r\n <http://www.w3.org/ns/prov#hadMember> <https://ww3.bgbm.org/biocase/pywrapper.c\r\ngi?dsa=GFBio_eXist-db&inventory=1> .\r\n<https://ww3.bgbm.org/biocase/pywrapper.cgi?dsa=GFBio_eXist-db&inventory=1> <htt\r\np://purl.org/dc/elements/1.1/format> \"text/xml\" .\r\n```\r\n\r\nSo, with this, you can add the hadMember relationship for bioCASe (#14) for older provenance logs using:\r\n```shell\r\n$ preston ls | grep \"pywrapper.cgi?dsa\" | grep hasVersion | preston process\r\n```\r\nfor the individual datasets (e.g., <data hash> hadMember <dwca url> and <dataset hash> hadMember <abcda url>).\r\n\r\nFor creating hadMembership relations for bioCASe registry something like:\r\n\r\n```shell\r\n$ preston ls | grep  \"https://bms.gfbio.org/services/data-sources/\" | grep \"hasVersion\" | preston process\r\n```\r\n\r\nNote that piping all of the provenance logs into preston will probably result is a giant single log with old and added statements. These logs might be > 1GB . \r\n\r\nAlso note that if we decide to go for this and patch the existing bioCASe provenance logs in the preston observatory in Germany, we'd have to run it there first, then sync. If you run it locally, you'll effectively fork your provenance log version history and won't see the newly added content from Germany. \r\n\r\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/bio-guoda/preston/issues/comments/511165769/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/bio-guoda/preston/issues/comments/511166150","html_url":"https://github.com/bio-guoda/preston/issues/15#issuecomment-511166150","issue_url":"https://api.github.com/repos/bio-guoda/preston/issues/15","id":511166150,"node_id":"MDEyOklzc3VlQ29tbWVudDUxMTE2NjE1MA==","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-07-14T01:42:04Z","updated_at":"2019-07-14T01:42:04Z","body":"Curious to hear you comments if you have any.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/bio-guoda/preston/issues/comments/511166150/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/bio-guoda/preston/issues/comments/511167012","html_url":"https://github.com/bio-guoda/preston/issues/15#issuecomment-511167012","issue_url":"https://api.github.com/repos/bio-guoda/preston/issues/15","id":511167012,"node_id":"MDEyOklzc3VlQ29tbWVudDUxMTE2NzAxMg==","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-07-14T02:06:23Z","updated_at":"2019-07-14T04:46:35Z","body":"Functionality is included in https://github.com/bio-guoda/preston/releases/tag/0.1.2 . \r\n\r\nAm now running tests for patching bioCASe provenance logs with:\r\n\r\n```preston ls --remote https://deeplinker.bio | grep \"pywrapper.cgi?dsa\" | grep \"hasVersion\" | preston process --remote https://deeplinker.bio```\r\n\r\nstarting from a clean local preston repository.\r\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/bio-guoda/preston/issues/comments/511167012/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/bio-guoda/preston/issues/comments/511173820","html_url":"https://github.com/bio-guoda/preston/issues/15#issuecomment-511173820","issue_url":"https://api.github.com/repos/bio-guoda/preston/issues/15","id":511173820,"node_id":"MDEyOklzc3VlQ29tbWVudDUxMTE3MzgyMA==","user":{"login":"jhpoelen","id":1084872,"node_id":"MDQ6VXNlcjEwODQ4NzI=","avatar_url":"https://avatars.githubusercontent.com/u/1084872?v=4","gravatar_id":"","url":"https://api.github.com/users/jhpoelen","html_url":"https://github.com/jhpoelen","followers_url":"https://api.github.com/users/jhpoelen/followers","following_url":"https://api.github.com/users/jhpoelen/following{/other_user}","gists_url":"https://api.github.com/users/jhpoelen/gists{/gist_id}","starred_url":"https://api.github.com/users/jhpoelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhpoelen/subscriptions","organizations_url":"https://api.github.com/users/jhpoelen/orgs","repos_url":"https://api.github.com/users/jhpoelen/repos","events_url":"https://api.github.com/users/jhpoelen/events{/privacy}","received_events_url":"https://api.github.com/users/jhpoelen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-07-14T05:08:46Z","updated_at":"2019-07-14T05:09:15Z","body":"See attached for results of:\r\n1. biocase registry members via ```preston ls --remote https://deeplinker.bio | grep -e \"https://bms.gfbio.org/services/data-sources/\" | preston process --remote https://deeplinker.bio``` \r\n[biocase_registry_members.nq.gz](https://github.com/bio-guoda/preston/files/3389484/biocase_registry_members.nq.gz)\r\n\r\n\r\n\r\n2. biocase dataset members via ```preston ls --remote https://deeplinker.bio | grep \"pywrapper.cgi?dsa\" | grep \"hasVersion\" | preston process --remote https://deeplinker.bio``` \r\n[biocase_dataset_members.nq.gz](https://github.com/bio-guoda/preston/files/3389481/biocase_dataset_members.nq.gz)\r\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/bio-guoda/preston/issues/comments/511173820/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/bio-guoda/preston/issues/comments/532346233","html_url":"https://github.com/bio-guoda/preston/issues/15#issuecomment-532346233","issue_url":"https://api.github.com/repos/bio-guoda/preston/issues/15","id":532346233,"node_id":"MDEyOklzc3VlQ29tbWVudDUzMjM0NjIzMw==","user":{"login":"mielliott","id":9602463,"node_id":"MDQ6VXNlcjk2MDI0NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9602463?v=4","gravatar_id":"","url":"https://api.github.com/users/mielliott","html_url":"https://github.com/mielliott","followers_url":"https://api.github.com/users/mielliott/followers","following_url":"https://api.github.com/users/mielliott/following{/other_user}","gists_url":"https://api.github.com/users/mielliott/gists{/gist_id}","starred_url":"https://api.github.com/users/mielliott/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mielliott/subscriptions","organizations_url":"https://api.github.com/users/mielliott/orgs","repos_url":"https://api.github.com/users/mielliott/repos","events_url":"https://api.github.com/users/mielliott/events{/privacy}","received_events_url":"https://api.github.com/users/mielliott/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-09-17T18:33:20Z","updated_at":"2019-09-17T18:33:20Z","body":"Functionality has been added, closing.","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/bio-guoda/preston/issues/comments/532346233/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]