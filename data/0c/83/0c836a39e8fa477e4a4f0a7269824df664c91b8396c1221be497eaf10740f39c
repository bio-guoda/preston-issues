{"url":"https://api.github.com/repos/bio-guoda/preston/issues/125","repository_url":"https://api.github.com/repos/bio-guoda/preston","labels_url":"https://api.github.com/repos/bio-guoda/preston/issues/125/labels{/name}","comments_url":"https://api.github.com/repos/bio-guoda/preston/issues/125/comments","events_url":"https://api.github.com/repos/bio-guoda/preston/issues/125/events","html_url":"https://github.com/bio-guoda/preston/issues/125","id":915129857,"node_id":"MDU6SXNzdWU5MTUxMjk4NTc=","number":125,"title":"can't do `preston update` on content-based URIs","user":{"login":"mielliott","id":9602463,"node_id":"MDQ6VXNlcjk2MDI0NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9602463?v=4","gravatar_id":"","url":"https://api.github.com/users/mielliott","html_url":"https://github.com/mielliott","followers_url":"https://api.github.com/users/mielliott/followers","following_url":"https://api.github.com/users/mielliott/following{/other_user}","gists_url":"https://api.github.com/users/mielliott/gists{/gist_id}","starred_url":"https://api.github.com/users/mielliott/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mielliott/subscriptions","organizations_url":"https://api.github.com/users/mielliott/orgs","repos_url":"https://api.github.com/users/mielliott/repos","events_url":"https://api.github.com/users/mielliott/events{/privacy}","received_events_url":"https://api.github.com/users/mielliott/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2021-06-08T14:42:39Z","updated_at":"2021-06-08T14:48:44Z","closed_at":null,"author_association":"COLLABORATOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"`preston update` throws an error when trying to dereference content-based URIs:\r\n\r\n```\r\n$ preston update 'hash://sha256/97cbeae429fbc95d1859f7afa28b33f08ac64125ba72511c49c4b77ca66d2d66'\r\n<https://preston.guoda.bio> <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://www.w3.org/ns/prov#SoftwareAgent> <urn:uuid:c716b299-09e1-401d-8b7d-f5fd948694f6> .\r\n<https://preston.guoda.bio> <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://www.w3.org/ns/prov#Agent> <urn:uuid:c716b299-09e1-401d-8b7d-f5fd948694f6> .\r\n<https://preston.guoda.bio> <http://purl.org/dc/terms/description> \"Preston is a software program that finds, archives and provides access to biodiversity datasets.\"@en <urn:uuid:c716b299-09e1-401d-8b7d-f5fd948694f6> .\r\n<urn:uuid:c716b299-09e1-401d-8b7d-f5fd948694f6> <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://www.w3.org/ns/prov#Activity> <urn:uuid:c716b299-09e1-401d-8b7d-f5fd948694f6> .\r\n<urn:uuid:c716b299-09e1-401d-8b7d-f5fd948694f6> <http://purl.org/dc/terms/description> \"A crawl event that discovers biodiversity archives.\"@en <urn:uuid:c716b299-09e1-401d-8b7d-f5fd948694f6> .\r\n<urn:uuid:c716b299-09e1-401d-8b7d-f5fd948694f6> <http://www.w3.org/ns/prov#startedAtTime> \"2021-06-08T14:36:24.593Z\"^^<http://www.w3.org/2001/XMLSchema#dateTime> <urn:uuid:c716b299-09e1-401d-8b7d-f5fd948694f6> .\r\n<urn:uuid:c716b299-09e1-401d-8b7d-f5fd948694f6> <http://www.w3.org/ns/prov#wasStartedBy> <https://preston.guoda.bio> <urn:uuid:c716b299-09e1-401d-8b7d-f5fd948694f6> .\r\n<https://doi.org/10.5281/zenodo.1410543> <http://www.w3.org/ns/prov#usedBy> <urn:uuid:c716b299-09e1-401d-8b7d-f5fd948694f6> <urn:uuid:c716b299-09e1-401d-8b7d-f5fd948694f6> .\r\n<https://doi.org/10.5281/zenodo.1410543> <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://purl.org/dc/dcmitype/Software> <urn:uuid:c716b299-09e1-401d-8b7d-f5fd948694f6> .\r\n<https://doi.org/10.5281/zenodo.1410543> <http://purl.org/dc/terms/bibliographicCitation> \"Jorrit Poelen, Icaro Alzuru, & Michael Elliott. 2019. Preston: a biodiversity dataset tracker (Version 0.0.1-SNAPSHOT) [Software]. Zenodo. http://doi.org/10.5281/zenodo.1410543\"@en <urn:uuid:c716b299-09e1-401d-8b7d-f5fd948694f6> .\r\n<urn:uuid:0659a54f-b713-4f86-a917-5be166a14110> <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://www.w3.org/ns/prov#Entity> <urn:uuid:c716b299-09e1-401d-8b7d-f5fd948694f6> .\r\n<urn:uuid:0659a54f-b713-4f86-a917-5be166a14110> <http://purl.org/dc/terms/description> \"A biodiversity dataset graph archive.\"@en <urn:uuid:c716b299-09e1-401d-8b7d-f5fd948694f6> .\r\n<hash://sha256/6d924b3cc007cdb2fd78eab535dd9102563ebdddf4e0e30b00b50bde555f5e68> <http://www.w3.org/ns/prov#usedBy> <urn:uuid:c716b299-09e1-401d-8b7d-f5fd948694f6> <urn:uuid:c716b299-09e1-401d-8b7d-f5fd948694f6> .\r\n[main] WARN bio.guoda.preston.store.Archiver - failed to dereference [<hash://sha256/97cbeae429fbc95d1859f7afa28b33f08ac64125ba72511c49c4b77ca66d2d66>]\r\norg.apache.http.client.ClientProtocolException\r\n        at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:187)\r\n        at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:83)\r\n        at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:108)\r\n        at bio.guoda.preston.ResourcesHTTP.asInputStream(ResourcesHTTP.java:75)\r\n        at bio.guoda.preston.ResourcesHTTP.asInputStream(ResourcesHTTP.java:55)\r\n        at bio.guoda.preston.ResourcesHTTP.asInputStream(ResourcesHTTP.java:59)\r\n        at bio.guoda.preston.store.DereferencerContentAddressed.dereference(DereferencerContentAddressed.java:19)\r\n        at bio.guoda.preston.store.DereferencerContentAddressed.dereference(DereferencerContentAddressed.java:8)\r\n        at bio.guoda.preston.store.Archiver.handleBlankVersion(Archiver.java:49)\r\n        at bio.guoda.preston.store.VersionProcessor.on(VersionProcessor.java:28)\r\n        at bio.guoda.preston.process.StatementsListenerEmitterAdapter.on(StatementsListenerEmitterAdapter.java:12)\r\n        at bio.guoda.preston.cmd.CmdUpdate.processQueue(CmdUpdate.java:61)\r\n        at bio.guoda.preston.cmd.CmdActivity.run(CmdActivity.java:124)\r\n        at bio.guoda.preston.cmd.CmdActivity.run(CmdActivity.java:77)\r\n        at bio.guoda.preston.cmd.CmdLine.run(CmdLine.java:18)\r\n        at bio.guoda.preston.cmd.CmdLine.run(CmdLine.java:26)\r\n        at bio.guoda.preston.Preston.main(Preston.java:19)\r\nCaused by: org.apache.http.HttpException: hash protocol is not supported\r\n        at org.apache.http.impl.conn.DefaultRoutePlanner.determineRoute(DefaultRoutePlanner.java:89)\r\n        at org.apache.http.impl.client.InternalHttpClient.determineRoute(InternalHttpClient.java:125)\r\n        at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:184)\r\n        ... 16 more\r\n<https://deeplinker.bio/.well-known/genid/aa0abea3-9689-3cc9-a467-ccfde0d5544f> <http://www.w3.org/ns/prov#wasGeneratedBy> <urn:uuid:a2a5c80e-32fc-490d-9615-316e7f2e24bd> <urn:uuid:a2a5c80e-32fc-490d-9615-316e7f2e24bd> .\r\n<https://deeplinker.bio/.well-known/genid/aa0abea3-9689-3cc9-a467-ccfde0d5544f> <http://www.w3.org/ns/prov#qualifiedGeneration> <urn:uuid:a2a5c80e-32fc-490d-9615-316e7f2e24bd> <urn:uuid:a2a5c80e-32fc-490d-9615-316e7f2e24bd> .\r\n<urn:uuid:a2a5c80e-32fc-490d-9615-316e7f2e24bd> <http://www.w3.org/ns/prov#generatedAtTime> \"2021-06-08T14:36:25.373Z\"^^<http://www.w3.org/2001/XMLSchema#dateTime> <urn:uuid:a2a5c80e-32fc-490d-9615-316e7f2e24bd> .\r\n<urn:uuid:a2a5c80e-32fc-490d-9615-316e7f2e24bd> <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://www.w3.org/ns/prov#Generation> <urn:uuid:a2a5c80e-32fc-490d-9615-316e7f2e24bd> .\r\n<urn:uuid:a2a5c80e-32fc-490d-9615-316e7f2e24bd> <http://www.w3.org/ns/prov#wasInformedBy> <urn:uuid:c716b299-09e1-401d-8b7d-f5fd948694f6> <urn:uuid:a2a5c80e-32fc-490d-9615-316e7f2e24bd> .\r\n<urn:uuid:a2a5c80e-32fc-490d-9615-316e7f2e24bd> <http://www.w3.org/ns/prov#used> <hash://sha256/97cbeae429fbc95d1859f7afa28b33f08ac64125ba72511c49c4b77ca66d2d66> <urn:uuid:a2a5c80e-32fc-490d-9615-316e7f2e24bd> .\r\n<hash://sha256/97cbeae429fbc95d1859f7afa28b33f08ac64125ba72511c49c4b77ca66d2d66> <http://purl.org/pav/hasVersion> <https://deeplinker.bio/.well-known/genid/aa0abea3-9689-3cc9-a467-ccfde0d5544f> <urn:uuid:a2a5c80e-32fc-490d-9615-316e7f2e24bd> .\r\n```\r\n\r\nUse case: after finding records (lines) in datasets using `preston grep`, I thought it would be fun to hash each of the lines so that I could see which ones have identical content. `preston update` seemed like a convenient way to do this.\r\n\r\nThis ties into an old idea of verifying the reliability (as defined in Elliott et al. 2020) of preston datasets by running `preston update` on an existing preston-generated provenance log, which we imagined should find the same exact content, since it would dereference content-based identifiers instead of location-based ones.","closed_by":null,"reactions":{"url":"https://api.github.com/repos/bio-guoda/preston/issues/125/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/bio-guoda/preston/issues/125/timeline","performed_via_github_app":null,"state_reason":null}